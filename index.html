<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Your French - Quiz Interactif</title>
    <meta name="description" content="Testez votre niveau de français avec ce quiz rapide et découvrez votre score !">
    
    <!-- Meta tags PWA -->
    <meta name="theme-color" content="#111f46">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Test Your French">
    
    <!-- Manifeste PWA -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Icônes -->
    <link rel="icon" href="icons/icon-72x72.png" type="image/png">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Font Awesome pour les icônes -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Script pour l'enregistrement du Service Worker -->
    <script>
        // Vérifier si les Service Workers sont supportés
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('sw.js');
                    console.log('Service Worker enregistré avec succès:', registration.scope);
                } catch (error) {
                    console.error('Échec de l\'enregistrement du Service Worker:', error);
                }
            });
        }
    </script>
</head>
<body>
    <header>
        <h1>Test Your French</h1>
        <p class="subtitle">Évaluez votre niveau de français</p>
    </header>

    <main class="quiz-container">
        <!-- Écran d'accueil -->
        <div id="welcome-screen" class="screen">
            <h2>French Quiz - Test Your Basic Knowledge</h2>
            <p>Ce quiz va tester vos connaissances de base en français.</p>
            <p>10 questions pour évaluer votre niveau selon le CECRL.</p>
            
            <div class="buttons">
                <button id="start-quiz" class="btn">
                    <i class="fas fa-play btn-icon"></i> Commencer le Quiz
                </button>
            </div>
        </div>

        <!-- Écran du quiz -->
        <div id="quiz-screen" class="screen hidden">
            <!-- Barre de progression -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress" id="progress-bar"></div>
                </div>
                <div class="progress-steps" id="progress-steps"></div>
            </div>
            
            <!-- Container pour les questions -->
            <div id="question-container" class="question-container">
                <p id="question-number" class="sr-only">Question 1 sur 10</p>
                <p id="question-text" class="question-text"></p>
                
                <!-- Container pour l'audio (si nécessaire) -->
                <div id="audio-container" class="audio-container hidden">
                    <audio id="question-audio" controls>
                        <source src="" type="audio/mpeg">
                        Votre navigateur ne supporte pas l'élément audio.
                    </audio>
                </div>
                
                <!-- Options de réponse -->
                <div id="options" class="options"></div>
                
                <!-- Feedback après réponse -->
                <div id="feedback" class="feedback-container">
                    <div id="feedback-correct" class="feedback-correct hidden">
                        <h3><i class="fas fa-check-circle"></i> Correct !</h3>
                        <p id="feedback-correct-text"></p>
                    </div>
                    <div id="feedback-incorrect" class="feedback-incorrect hidden">
                        <h3><i class="fas fa-times-circle"></i> Incorrect</h3>
                        <p id="feedback-incorrect-text"></p>
                    </div>
                </div>
            </div>
            
            <!-- Boutons de navigation -->
            <div class="buttons">
                <div class="button-group">
                    <button id="prev-btn" class="btn btn-secondary" disabled>
                        <i class="fas fa-arrow-left btn-icon"></i> Précédent
                    </button>
                </div>
                <div class="button-group">
                    <button id="next-btn" class="btn" disabled>
                        Suivant <i class="fas fa-arrow-right btn-icon"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Écran des résultats -->
        <div id="results-screen" class="screen hidden">
            <h2>Résultats du Quiz</h2>
            <p>Vous avez terminé le quiz !</p>
            
            <div class="score-highlight">
                <span id="score">0</span>/10
            </div>
            
            <div id="level-result">
                <!-- Le niveau sera inséré ici par JavaScript -->
            </div>
            
            <div class="certificate">
                <h2>Certificat de Niveau</h2>
                <div class="certificate-content">
                    Ce certificat atteste que
                    <div class="certificate-name">
                        <span id="user-name">Participant</span>
                    </div>
                    a obtenu le score de
                    <div class="certificate-score">
                        <span id="certificate-score">0</span>/10
                    </div>
                    et a atteint le niveau
                    <div class="certificate-level" id="certificate-level">
                        <!-- Le niveau sera inséré ici par JavaScript -->
                    </div>
                    <div class="certificate-date">
                        <span id="certificate-date"></span>
                    </div>
                </div>
            </div>
            
            <div class="buttons">
                <button id="restart-btn" class="btn">
                    <i class="fas fa-redo btn-icon"></i> Recommencer
                </button>
                <button id="share-btn" class="btn">
                    <i class="fas fa-share-alt btn-icon"></i> Partager
                </button>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <a href="https://www.testyourfrench.com" class="footer-logo" target="_blank" rel="noopener">
                Test Your French
            </a>
            <p class="footer-text">Improve your French today!</p>
        </div>
    </footer>

    <!-- Script pour les notifications PWA -->
    <script>
        // Notifications PWA
        
        // 1. Notification hors-ligne
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.addEventListener('message', event => {
                if (event.data && event.data.type === 'offline-ready') {
                    showOfflineNotification();
                }
            });
        }
        
        // 2. Invitation à installer
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Afficher la notification d'installation après 10 secondes
            setTimeout(() => {
                if (deferredPrompt) {
                    showInstallNotification();
                }
            }, 10000);
        });
        
        // Fonctions pour les notifications
        function showOfflineNotification() {
            const notification = document.createElement('div');
            notification.className = 'offline-notification';
            notification.innerHTML = `
                <i class="fas fa-wifi"></i> Ce quiz est maintenant disponible hors-ligne !
                <button class="close-notification" aria-label="Fermer la notification"><i class="fas fa-times"></i></button>
            `;
            document.body.appendChild(notification);
            
            // Fermer la notification
            notification.querySelector('.close-notification').addEventListener('click', () => {
                notification.classList.add('fade-out');
                setTimeout(() => notification.remove(), 500);
            });
            
            // Disparaître après 5 secondes
            setTimeout(() => {
                notification.classList.add('fade-out');
                setTimeout(() => notification.remove(), 500);
            }, 5000);
        }
        
        function showInstallNotification() {
            const notification = document.createElement('div');
            notification.className = 'install-notification';
            notification.innerHTML = `
                <i class="fas fa-download"></i> 
                <p>Installez ce quiz sur votre appareil pour y accéder plus facilement et l'utiliser hors-ligne !</p>
                <div class="install-buttons">
                    <button id="install-now" class="btn btn-sm">Installer</button>
                    <button id="install-later" class="btn btn-sm btn-secondary">Plus tard</button>
                </div>
                <button class="close-notification" aria-label="Fermer la notification"><i class="fas fa-times"></i></button>
            `;
            document.body.appendChild(notification);
            
            // Gérer les événements des boutons
            document.getElementById('install-now').addEventListener('click', async () => {
                notification.remove();
                
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    deferredPrompt = null;
                }
            });
            
            document.getElementById('install-later').addEventListener('click', () => {
                notification.remove();
            });
            
            notification.querySelector('.close-notification').addEventListener('click', () => {
                notification.classList.add('fade-out');
                setTimeout(() => notification.remove(), 500);
            });
        }
    </script>

    <!-- Script principal du quiz -->
    <script>
        // Définition des questions du quiz
        const questions = [
            {
                text: "How do you say \"My name is\"? (informal)",
                options: [
                    "Je m'appelle",
                    "Je viens vous",
                    "J'ai le nommé",
                    "J'ai une montre"
                ],
                correctIndex: 0,
                explanation: "Literally, <strong>\"I call myself\"</strong>."
            },
            {
                text: "How do you say \"I'm from New Orleans\"?",
                options: [
                    "J'aime la Nouvelle-Orléans.",
                    "Je habiter Nouvelle-Orléans.",
                    "Je viens de la Nouvelle-Orléans.",
                    "All of the above"
                ],
                correctIndex: 2,
                explanation: "This is the most natural and idiomatic way to say \"I am from New Orleans\" in French. The verb <strong>\"venir de\"</strong> (to come from) is commonly used to express origin or birthplace.<br><br><strong>\"J'aime la Nouvelle-Orléans\"</strong> means \"I love New Orleans.\" This phrase doesn't accurately convey the meaning of \"being from\" a place.<br><br><strong>\"Je habiter à la Nouvelle-Orléans\"</strong> means \"I to inhabit at New Orleans.\" This phrase is not grammatically correct and sounds awkward."
            },
            {
                text: "How do you say \"You're welcome\"?",
                options: [
                    "De rien",
                    "Avec plaisir",
                    "Je vous en prie",
                    "All of the above"
                ],
                correctIndex: 3,
                explanation: "<strong>All the answers are correct.</strong><br><br><strong>\"De rien\"</strong> is the most common and casual way to say you're welcome, and it literally means \"it's nothing\".<br><br><strong>\"Avec plaisir\"</strong> means with pleasure, and it's a friendly and enthusiastic way to say \"you're welcome\".<br><br><strong>\"Je vous en prie\"</strong> is a formal and polite way to say you're welcome, and it literally means \"I beg of you\".<br><br><strong>Cultural insight</strong> for \"je vous en prie\": its roots lie in the Middle Ages, likely emerging around the 13th-14th centuries. Back then, \"prier\" (to pray) wasn't just about requesting or begging, it also carried a strong sense of expressing reverence and devotion."
            },
            {
                text: "How do you say \"Good evening\"? (as a hello)",
                options: [
                    "Bonne nuit",
                    "Bonsoir",
                    "Bon après-midi",
                    "Bonne soirée"
                ],
                correctIndex: 1,
                explanation: "<strong>\"Bonsoir\"</strong> is the correct way to say good evening in French.<br><br><strong>\"Bonne nuit\"</strong> means good night, and it's used when you're going to bed or leaving someone for the night.<br><br><strong>\"Bon après-midi\"</strong> means good afternoon.<br><br><strong>\"Bonne soirée\"</strong> means \"have a good evening\" and specifically conveys the hope that someone has a pleasant evening ahead."
            },
            {
                text: "How do you say \"How are you doing\"? (formal)",
                options: [
                    "Comment allez-vous ?",
                    "Ça boom ?",
                    "C'est beau la vie ?",
                    "All of the above"
                ],
                correctIndex: 0,
                explanation: "<strong>\"Comment allez-vous ?\"</strong> is the formal and polite way to ask, and it's used with strangers, acquaintances, or superiors.<br><br><strong>\"Ça boom ?\"</strong> is very casual and a bit outdated (not formal).<br><br><strong>\"C'est beau la vie ?\"</strong> is informal and friendly, and it's used with friends."
            },
            {
                text: "Listen to this. What is she saying?",
                options: [
                    "Tu viens chez moi ?",
                    "Tu vas loin ?",
                    "Tu viens d'où ?",
                    "Tu tiens ton chien ?"
                ],
                correctIndex: 2,
                explanation: "<strong>\"Tu viens d'où ?\"</strong> <em>(Where are you from?)</em>",
                audio: "TYF_Lead_6.mp3"
            },
            {
                text: "Listen to this. What is she saying?",
                options: [
                    "Tu es étudiant ?",
                    "Tu pars où ?",
                    "Tu étudies à l'université ?",
                    "Tu as étudié où ?"
                ],
                correctIndex: 3,
                explanation: "<strong>\"Tu as étudié où ?\"</strong> <em>(Where did you study?)</em>",
                audio: "TYF_Lead_7.mp3"
            },
            {
                text: "Bonjour, c'est la première fois que je viens. Je ________ ? (fill the blank)",
                options: [
                    "veux vous boire la verre ?",
                    "vois la musique est bonne ?",
                    "peux m'asseoir ici",
                    "vous excuse pas du tout ?"
                ],
                correctIndex: 2,
                explanation: "<strong>\"Bonjour, c'est la première fois que je viens. Je peux m'asseoir ici ?\"</strong><br><em>(Hello, this is my first time here. May I sit here?)</em><br><br>The other options are not grammatically correct."
            },
            {
                text: "Excusez-moi, je tourne en rond. ___ ? (fill the blank)",
                options: [
                    "Pouvez-vous m'indiquer le chemin pour le Louvre s'il vous plait",
                    "Montrez chemin musée sur carte.",
                    "Je veux Louvre maintenant.",
                    "All of the above"
                ],
                correctIndex: 0,
                explanation: "<strong>\"Excusez-moi, je tourne en rond. Pouvez-vous m'indiquer le chemin pour le Louvre s'il vous plait ?\"</strong><br><em>(Excuse me, I'm going round in circles/I'm lost. Could you please show me the way to the Louvre?)</em><br><br>It's the only sentence that is correct grammatically and that is polite and accurate.<br><br><strong>\"Montrez chemin musée carte.\"</strong> This is not a question, but rather a request with a list of words and this does not specify which museum.<br><br><strong>\"Je veux Louvre maintenant.\"</strong> It doesn't explicitly ask someone to provide guidance on how to get there and it sounds rude.<br><br><strong>Tip:</strong> in France, it is always best to say \"s'il vous plait\" in all your interactions."
            },
            {
                text: "________ m'inscrire à ce cours. (fill the blank)",
                options: [
                    "Je suis en voiture",
                    "Tu veux le vélo pour",
                    "Je cherche un lapin",
                    "Bonjour, j'aimerais"
                ],
                correctIndex: 3,
                explanation: "<strong>\"Bonjour, j'aimerais m'inscrire à ce cours.\"</strong><br><em>(Hello, I would like to register for this course.)</em><br><br>In French, we use the conditional of \"vouloir\" (to want) to ask for something politely.<br>Example: I would like a coffee."
            }
        ];

        // Déclaration des variables globales
        let currentQuestion = 0;
        let score = 0;
        let userAnswers = Array(questions.length).fill(null);
        let selectedOption = null;

        // Attendre que le DOM soit complètement chargé
        document.addEventListener('DOMContentLoaded', function() {
            initQuiz();
        });

        // Éléments DOM
        function initQuiz() {
            console.log("Initialisation du quiz...");
            
            // Récupération des éléments du DOM
            const welcomeScreen = document.getElementById('welcome-screen');
            const quizScreen = document.getElementById('quiz-screen');
            const resultsScreen = document.getElementById('results-screen');
            const startBtn = document.getElementById('start-quiz');
            const nextBtn = document.getElementById('next-btn');
            const prevBtn = document.getElementById('prev-btn');
            const restartBtn = document.getElementById('restart-btn');
            const shareBtn = document.getElementById('share-btn');
            const questionText = document.getElementById('question-text');
            const questionNumber = document.getElementById('question-number');
            const optionsContainer = document.getElementById('options');
            const progressBar = document.getElementById('progress-bar');
            const progressSteps = document.getElementById('progress-steps');
            const feedbackContainer = document.getElementById('feedback');
            const feedbackCorrect = document.getElementById('feedback-correct');
            const feedbackIncorrect = document.getElementById('feedback-incorrect');
            const feedbackCorrectText = document.getElementById('feedback-correct-text');
            const feedbackIncorrectText = document.getElementById('feedback-incorrect-text');
            const scoreElement = document.getElementById('score');
            const levelResult = document.getElementById('level-result');
            const certificateScore = document.getElementById('certificate-score');
            const certificateLevel = document.getElementById('certificate-level');
            const certificateDate = document.getElementById('certificate-date');
            const audioContainer = document.getElementById('audio-container');
            const questionAudio = document.getElementById('question-audio');
            
            // Créer les étapes de progression
            progressSteps.innerHTML = '';
            for (let i = 0; i < questions.length; i++) {
                const step = document.createElement('div');
                step.className = 'step';
                step.textContent = i + 1;
                
                if (i === 0) {
                    step.classList.add('active');
                }
                
                progressSteps.appendChild(step);
            }
            
            // Afficher la première question
            showQuestion(currentQuestion);
            
            // Démarrer le quiz
            function startQuiz() {
                console.log("Démarrage du quiz...");
                welcomeScreen.classList.add('hidden');
                quizScreen.classList.remove('hidden');
            }
            
            // Afficher une question
            function showQuestion(index) {
                console.log(`Affichage de la question ${index + 1}`);
                
                // Mettre à jour le texte de la question
                questionText.textContent = questions[index].text;
                questionNumber.textContent = `Question ${index + 1} sur ${questions.length}`;
                
                // Gérer l'audio si présent
                if (questions[index].audio) {
                    audioContainer.classList.remove('hidden');
                    questionAudio.src = `audio/${questions[index].audio}`;
                    questionAudio.load();
                } else {
                    audioContainer.classList.add('hidden');
                    questionAudio.src = '';
                }
                
                // Créer les options
                optionsContainer.innerHTML = '';
                questions[index].options.forEach((option, i) => {
                    const optionElement = document.createElement('div');
                    optionElement.className = 'option';
                    optionElement.textContent = option;
                    optionElement.setAttribute('data-index', i);
                    optionElement.tabIndex = 0;
                    
                    // Ajouter la classe 'selected' si cette option a déjà été sélectionnée
                    if (userAnswers[index] === i) {
                        optionElement.classList.add('selected');
                        selectedOption = optionElement;
                    }
                    
                    // Ajouter l'événement de clic
                    optionElement.addEventListener('click', function() {
                        selectOption(this);
                    });
                    
                    // Ajouter l'événement clavier (accessibilité)
                    optionElement.addEventListener('keydown', function(e) {
                        if (e.code === 'Enter' || e.code === 'Space') {
                            e.preventDefault();
                            selectOption(this);
                        }
                    });
                    
                    optionsContainer.appendChild(optionElement);
                });
                
                // Mettre à jour la barre de progression
                updateProgress();
                
                // Afficher le feedback si une réponse a déjà été donnée
                if (userAnswers[index] !== null) {
                    showFeedback(index, userAnswers[index]);
                } else {
                    hideFeedback();
                }
                
                // Activer/désactiver les boutons de navigation
                prevBtn.disabled = index === 0;
                nextBtn.disabled = userAnswers[index] === null;
                
                if (index === questions.length - 1) {
                    nextBtn.innerHTML = 'Terminer <i class="fas fa-check btn-icon"></i>';
                } else {
                    nextBtn.innerHTML = 'Suivant <i class="fas fa-arrow-right btn-icon"></i>';
                }
            }
            
            // Sélectionner une option
            function selectOption(optionElement) {
                console.log("Option sélectionnée");
                
                // Retirer la classe 'selected' de l'option précédemment sélectionnée
                if (selectedOption) {
                    selectedOption.classList.remove('selected');
                }
                
                // Ajouter la classe 'selected' à l'option sélectionnée
                optionElement.classList.add('selected');
                selectedOption = optionElement;
                
                // Enregistrer la réponse
                const selectedIndex = parseInt(optionElement.getAttribute('data-index'));
                userAnswers[currentQuestion] = selectedIndex;
                
                // Afficher le feedback
                showFeedback(currentQuestion, selectedIndex);
                
                // Activer le bouton suivant
                nextBtn.disabled = false;
                console.log("Bouton Suivant activé");
                
                // Mettre à jour la progression
                updateProgress();
            }
            
            // Afficher le feedback
            function showFeedback(questionIndex, selectedIndex) {
                const isCorrect = selectedIndex === questions[questionIndex].correctIndex;
                
                // Ajouter les classes correct/incorrect aux options
                const options = document.querySelectorAll('.option');
                options.forEach((option, i) => {
                    option.classList.remove('correct', 'incorrect');
                    if (i === questions[questionIndex].correctIndex) {
                        option.classList.add('correct');
                    } else if (i === selectedIndex && !isCorrect) {
                        option.classList.add('incorrect');
                    }
                });
                
                // Afficher le feedback
                feedbackContainer.classList.add('visible');
                
                if (isCorrect) {
                    feedbackCorrect.classList.remove('hidden');
                    feedbackIncorrect.classList.add('hidden');
                    feedbackCorrectText.innerHTML = questions[questionIndex].explanation;
                } else {
                    feedbackCorrect.classList.add('hidden');
                    feedbackIncorrect.classList.remove('hidden');
                    feedbackIncorrectText.innerHTML = questions[questionIndex].explanation;
                }
            }
            
            // Cacher le feedback
            function hideFeedback() {
                feedbackContainer.classList.remove('visible');
            }
            
            // Mettre à jour la progression
            function updateProgress() {
                // Mettre à jour la barre de progression
                const progress = ((currentQuestion + 1) / questions.length) * 100;
                progressBar.style.width = `${progress}%`;
                
                // Mettre à jour les étapes
                const steps = document.querySelectorAll('.step');
                steps.forEach((step, i) => {
                    step.classList.remove('active', 'completed', 'error');
                    
                    if (i === currentQuestion) {
                        step.classList.add('active');
                    } else if (i < currentQuestion) {
                        if (userAnswers[i] === questions[i].correctIndex) {
                            step.classList.add('completed');
                        } else {
                            step.classList.add('error');
                        }
                    }
                });
            }
            
            // Question suivante
            function nextQuestion() {
                console.log("Bouton Suivant cliqué");
                if (currentQuestion < questions.length - 1) {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                } else {
                    finishQuiz();
                }
            }
            
            // Question précédente
            function prevQuestion() {
                console.log("Bouton Précédent cliqué");
                if (currentQuestion > 0) {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                }
            }
            
            // Terminer le quiz
            function finishQuiz() {
                console.log("Fin du quiz");
                
                // Calculer le score
                score = userAnswers.reduce((total, answer, index) => {
                    return total + (answer === questions[index].correctIndex ? 1 : 0);
                }, 0);
                
                // Afficher le score
                scoreElement.textContent = score;
                certificateScore.textContent = score;
                
                // Déterminer le niveau
                let level = '';
                let levelDescription = '';
                
                if (score >= 8) {
                    level = 'A2';
                    levelDescription = 'You have mastered the basics of French communication. You can introduce yourself, ask for directions, and understand simple phrases used in everyday life.';
                } else if (score >= 6) {
                    level = 'A1+';
                    levelDescription = 'You know the fundamentals and are approaching the A2 level. With a bit more practice on everyday expressions, you\'ll soon reach the A2 level.';
                } else if (score >= 4) {
                    level = 'A1';
                    levelDescription = 'You know some basic expressions, but you still need to practice to reach level A2. Keep learning!';
                } else if (score >= 2) {
                    level = 'Pre-A1';
                    levelDescription = 'You have started learning French. With more practice on basic expressions, you\'ll progress to A1 level.';
                } else {
                    level = 'Beginner';
                    levelDescription = 'You\'re just beginning with French. Don\'t worry! Everyone starts somewhere. Keep practicing!';
                }
                
                // Afficher le niveau
                levelResult.innerHTML = `
                    <h3>Niveau: ${level}</h3>
                    <p>${levelDescription}</p>
                `;
                certificateLevel.textContent = level;
                
                // Afficher la date sur le certificat
                const now = new Date();
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                certificateDate.textContent = now.toLocaleDateString('fr-FR', options);
                
                // Afficher l'écran des résultats
                quizScreen.classList.add('hidden');
                resultsScreen.classList.remove('hidden');
            }
            
            // Partager les résultats
            function shareResults() {
                if (navigator.share) {
                    navigator.share({
                        title: 'Test Your French - Mon résultat',
                        text: `J'ai obtenu un score de ${score}/10 et atteint le niveau ${certificateLevel.textContent} au Test Your French Quiz !`,
                        url: window.location.href
                    })
                    .catch(error => console.log('Erreur de partage:', error));
                } else {
                    // Fallback si l'API de partage n'est pas disponible
                    alert(`Copiez ce texte pour partager: J'ai obtenu un score de ${score}/10 et atteint le niveau ${certificateLevel.textContent} au Test Your French Quiz !`);
                }
            }
            
            // Redémarrer le quiz
            function restartQuiz() {
                console.log("Redémarrage du quiz");
                
                // Réinitialiser les variables
                currentQuestion = 0;
                score = 0;
                userAnswers = Array(questions.length).fill(null);
                selectedOption = null;
                
                // Réinitialiser les étapes de progression
                const steps = document.querySelectorAll('.step');
                steps.forEach((step, i) => {
                    step.classList.remove('active', 'completed', 'error');
                    if (i === 0) {
                        step.classList.add('active');
                    }
                });
                
                // Retourner à l'écran du quiz
                resultsScreen.classList.add('hidden');
                quizScreen.classList.remove('hidden');
                
                // Afficher la première question
                showQuestion(0);
            }
            
            // Attacher les événements des boutons
            console.log("Attachement des événements des boutons...");
            startBtn.addEventListener('click', startQuiz);
            
            // Utilisation de fonctions nommées pour les écouteurs d'événements pour améliorer la lisibilité
            nextBtn.addEventListener('click', function(e) {
                console.log("Clic sur le bouton Suivant");
                nextQuestion();
            });
            
            prevBtn.addEventListener('click', function(e) {
                console.log("Clic sur le bouton Précédent");
                prevQuestion();
            });
            
            restartBtn.addEventListener('click', restartQuiz);
            shareBtn.addEventListener('click', shareResults);
            
            // Débug pour vérifier si les écouteurs sont bien attachés
            console.log("Initialisation terminée. Quiz prêt.");
        }
        
        // Lancer l'initialisation du quiz
        initQuiz();

        <script>
  // Script de correction pour les boutons de navigation
  document.addEventListener('DOMContentLoaded', function() {
    // Force le mode clair
    document.documentElement.style.setProperty('--bg', '#f9f9f9');
    document.documentElement.style.setProperty('--card-bg', 'white');
    document.documentElement.style.setProperty('--text', '#333');
    
    // Correctif pour les boutons
    document.getElementById('next-btn').onclick = function() {
      console.log("Bouton Suivant cliqué directement");
      if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        showQuestion(currentQuestion);
      } else {
        finishQuiz();
      }
    };
    
    document.getElementById('prev-btn').onclick = function() {
      console.log("Bouton Précédent cliqué directement");
      if (currentQuestion > 0) {
        currentQuestion--;
        showQuestion(currentQuestion);
      }
    };
  });
</script>
    </script>
</body>
</html>
